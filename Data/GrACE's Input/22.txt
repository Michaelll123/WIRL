<CurrentEdit>
<prefix>        COSDictionary trailer = document.getDocument().getTrailer();
        COSDictionary root = (COSDictionary) trailer.getDictionaryObject(COSName.ROOT);
        COSDictionary acroForm = (COSDictionary) root.getDictionaryObject(COSName.ACRO_FORM);
        COSArray fields = (COSArray) acroForm.getDictionaryObject(COSName.FIELDS);
        COSDictionary sig = null;
        for (int i = 0; i < fields.size(); i++)
        {
            COSDictionary field = (COSDictionary) fields.getObject(i);
            if (COSName.SIG.equals(field.getCOSName(COSName.FT)))
            {
                sig = (COSDictionary) field.getDictionaryObject(COSName.V);

                COSString contents = (COSString) sig.getDictionaryObject(COSName.CONTENTS);
                // inspiration:
                // http://stackoverflow.com/a/26702631/535646
</prefix>
<before>                CMSSignedData signedData = new CMSSignedData(Base64.decode(envelopedData.getBytes()));
</before>
<after></after>
<suffix>            }
        }
    }
}
</suffix>
</CurrentEdit>
<CtxEdits>
<Edit>
<prefix>        COSDictionary trailer = document.getDocument().getTrailer();
        COSDictionary root = (COSDictionary) trailer.getDictionaryObject(COSName.ROOT);
        COSDictionary acroForm = (COSDictionary) root.getDictionaryObject(COSName.ACRO_FORM);
        COSArray fields = (COSArray) acroForm.getDictionaryObject(COSName.FIELDS);
        COSDictionary sig = null;
        for (int i = 0; i < fields.size(); i++)
        {
            COSDictionary field = (COSDictionary) fields.getObject(i);
            if (COSName.SIG.equals(field.getCOSName(COSName.FT)))
            {
                sig = (COSDictionary) field.getDictionaryObject(COSName.V);

                COSString contents = (COSString) sig.getDictionaryObject(COSName.CONTENTS);
                // inspiration:
                // http://stackoverflow.com/a/26702631/535646
</prefix>
<before></before>
<after>                CMSSignedData signedData = new CMSSignedData(Base64.decode(envelopedData.getBytes()));
</after>
<suffix>            }
        }
    }
}
</suffix>
</Edit>
</CtxEdits>
